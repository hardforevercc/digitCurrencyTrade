<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 扩展mapper -->
<mapper namespace="com.okex.mybatis.dao.OkexExtMapper">

	
  
  <!-- 查找最近一笔买入数据 -->
  <select id="selectLastedBuyRecord"  resultMap="OkexTradeRecordMap">
	    select 
	    *
	    from okex_trade_record
	    where id = (select max(id) from okex_trade_record where isOk = "Y")
  </select>
  <!-- 查询平均持仓价格 -->
  <select id="selectMyAvgPriceRecord"  resultType="java.math.BigDecimal">
	    select 
	    sum(amt)/sum(curamount)
	    from okex_trade_record
	    where type = "buy" and isOk = "Y"
  </select>
  <!-- 查询最近买入价格 -->
  <select id="selectLastBuyPrice"  resultType="java.math.BigDecimal">
	    SELECT curprice FROM okex_trade_record WHERE id = (SELECT 
	    MAX(id) FROM okex_trade_record)
  </select>
  <!-- 查询已花费usdt -->
  <select id="selectCostUsdtByAda"  resultType="java.math.BigDecimal">
	    SELECT SUM(amt) FROM okex_trade_record WHERE type = "buy" AND isOk = "Y"
  </select>
  <resultMap id="OkexTradeRecordMap" type="com.okex.mybatis.model.OkexTradeRecord">
    <!--
      @MBG Generated
      This element is automatically generated by MyBatis Generator,Do not modify ! Generated on Sat Aug 11 15:59:16 GMT+08:00 2018.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="curprice" jdbcType="DECIMAL" property="curprice" />
    <result column="curamount" jdbcType="DECIMAL" property="curamount" />
    <result column="amt" jdbcType="DECIMAL" property="amt" />
    <result column="type" jdbcType="VARCHAR" property="type" />
    <result column="isOk" jdbcType="VARCHAR" property="isok" />
    <result column="create_date" jdbcType="TIMESTAMP" property="createDate" />
  </resultMap>
	
	
	
</mapper>